<?php 
$path = Session::get('language'); 
$control = Control::find(1);
?>
<?php $__env->startSection('title'); ?> Tarif d'écolage par niveau <?php $__env->stopSection(); ?>
<?php $__env->startSection('content'); ?> 
<!-- Workspace -->
<main class="workspace">
<section class="breadcrumb">        
<?php echo $__env->make('components.break', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
</section>
        <div class="grid lg:grid-cols-3 gap-5">
            <!-- Content -->
        <?php echo $__env->make('components.alerts', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>    
            <div class="lg:col-span-2">
            <div class="card p-5">
                    <table class="table table_striped w-full mt-3">
                        <thead>
                            <tr>
                                <th class="ltr:text-left rtl:text-right ">#</th>
                                <th class="ltr:text-left rtl:text-right ">Niveau</th>
                                <th class="ltr:text-left rtl:text-right ">Ecolage</th>
                                <th class="ltr:text-left rtl:text-right ">Droit d'inscription</th>
                                <th class="ltr:text-left rtl:text-right ">Montant Total</th>
                                <th class="ltr:text-left rtl:text-right ">Status</th>
                                <th class="text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                        <?php foreach($tarifs as $tarif): ?>
                            <tr>
                                <td><?php echo $tarif->id; ?></td>
                                <td><?php echo $tarif->niveau->name; ?></td>
                                <td><?php echo $tarif->ecolage . '' .$control->payment_unit; ?>/mois</td>
                                <td><?php echo $tarif->droit . '' .$control->payment_unit; ?></td>
                                <td><?php echo $tarif->total. '' .$control->payment_unit; ?></td>
                                <td>
                                <?php if($tarif->status == 1): ?><div class="badge badge_outlined badge_success">Oui</div> <?php else: ?> <div class="badge badge_outlined badge_danger">Non</div> <?php endif; ?>
                                </td>
                                <td>
                                <div class="inline-flex ltr:ml-auto rtl:mr-auto">
                                    <a href="<?php echo URL::current() . '?id=' . $tarif->id; ?>" class="btn btn-icon btn_outlined btn_success ltr:ml-2 rtl:mr-2">
                                        <span class="la la-pen-fancy"></span>
                                    </a>
                                    <?php if(Auth::user()->is_admin): ?> <?php if(!Auth::user()->is_secretaire): ?>
                                    <a onclick="return confirm('<?php echo Lang::get($path.'.delete'); ?>')" href="<?php echo URL::route('deletetarif', $tarif->id); ?>" class="btn btn-icon btn_outlined btn_danger ltr:ml-2 rtl:mr-2">
                                        <span class="la la-trash-alt"></span>
                                    </a>
                                    <?php endif; ?> <?php endif; ?>
                                </div>
                                </td>
                            </tr>
                        <?php endforeach; ?>
                        </tbody>
                    </table>
                </div>
            </div>
    <?php 
    if (isset($_GET['id'])) { 
    $id = htmlspecialchars($_GET['id']);
    $getEcoT = Tarif::find($id);
    if ($getEcoT !== null) {  ?>

            <div class="flex flex-col gap-y-5 lg:col-span-2 xl:col-span-1">
                <!-- Publish -->
                <div class="card p-5 flex flex-col gap-y-5">
                    <h3>Modifier Prix d'écolage</h3>
                  <div id="resultajax2" class="center"></div>    
                   <?php echo Form::open(['route'=>['updatetarif',$getEcoT->id], 'class'=>'', 'id'=>'myForm2', 'data-toggle'=>'validator']); ?>    
                       <div class="mb-5">
                          <label class="label block mb-2" for="class_id">Niveau</label>
                         <div class="custom-select">
                          <select class="form-control" name="class_id" id="class_id">
                               <?php if(!empty($getEcoT->class_id)): ?>
                                <option value="<?php echo $getEcoT->class_id; ?>" selected class="text-red-700"><h5><?php echo $getEcoT->niveau->short; ?></h5>
                                </option>
                               <?php else: ?>
                                <option value="" selected disabled>Choisir *</option>
                               <?php endif; ?>
                               <?php foreach($classes as $class): ?>
                                 <option value="<?php echo $class->id; ?>"><?php echo $class->short; ?></option>
                               <?php endforeach; ?>
                            </select>
                            <div class="custom-select-icon la la-caret-down"></div>
                        </div>
                        </div>
                        <div class="mb-5">
                            <label class="label block mb-2" for="ecolage">Ecolage par mois</label>
                            <input id="ecolage" name="ecolage" value="<?php echo $getEcoT->ecolage; ?>" type="text" class="form-control">
                        </div>
                        <div class="mb-5">
                            <label class="label block mb-2" for="droit">Droit d'inscription</label>
                            <input id="droit" name="droit" value="<?php echo $getEcoT->droit; ?>" type="text" class="form-control">
                        </div>
                         <div class="mb-5">
                            <label class="label block mb-2" for="total">Montant total</label>
                            <input id="total" name="total" value="<?php echo $getEcoT->total; ?>" type="text" class="form-control">
                        </div>
                        <div class="flex items-center">
                            <div class="w-1/2">
                                <label class="label block">Status</label>
                            </div>
                            <div class="w-3/4 ml-2">
                                <label class="label switch">
                                    <?php if($getEcoT->status == 1): ?>
                                    <input type="checkbox" name="status" checked value="1">
                                    <span></span>
                                    <span>Activé</span>
                                    <?php else: ?>
                                    <input type="checkbox" name="status" value="0">
                                    <span></span>
                                    <span>Désactiver</span>
                                    <?php endif; ?>
                                </label>
                            </div>
                        </div>
                        <div class="mt-10">
                            <button class="btn btn_primary uppercase">Metre à jour</button>
                        </div>
                      <?php echo Form::close(); ?>

<?php echo $__env->make('admin.tarifs.ajaxUp', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
                </div>
            </div>

<?php } } else { ?>

            <div class="flex flex-col gap-y-5 lg:col-span-2 xl:col-span-1">
                <!-- Publish -->
                <div class="card p-5 flex flex-col gap-y-5">
                    <h3>Ajouter le prix d'écolage</h3>
                    <div id="resultajax" class="center"></div>
            <?php echo Form::open(['route'=>'storetarif', 'class'=>'', 'id'=>'myForm', 'data-toggle'=>'validator']); ?> 
                        <div class="mb-5">
                          <label class="label block mb-2" for="class_id">Niveau</label>
                         <div class="custom-select">
                          <select class="form-control" name="class_id" id="class_id">
                            <option value="" disabled selected>--Choisir niveau--</option>   
                            <?php foreach($classes as $class): ?>
                                 <option value="<?php echo $class->id; ?>"><?php echo $class->short; ?></option>
                               <?php endforeach; ?>
                            </select>
                            <div class="custom-select-icon la la-caret-down"></div>
                        </div>
                        </div>
                        <div class="mb-5">
                            <label class="label block mb-2" for="ecolage">Ecolage par mois</label>
                            <input id="ecolage" name="ecolage" type="text" class="form-control">
                        </div>
                         <div class="mb-5">
                            <label class="label block mb-2" for="droit">Droit d'inscription</label>
                            <input id="droit" name="droit" type="text" class="form-control">
                        </div>
                         <div class="mb-5">
                            <label class="label block mb-2" for="title">Montant total</label>
                            <input id="total" name="total" type="text" class="form-control">
                        </div>
                        <div class="flex items-center">
                            <div class="w-1/2">
                                <label class="label block">Status</label>
                            </div>
                            <div class="w-3/4 ml-2">
                                <label class="label switch">
                                    <input type="checkbox" name="status" checked value="1">
                                    <span></span>
                                    <span>Activé</span>
                                </label>
                            </div>
                        </div>
                        <div class="mt-10">
                            <button type="submit" class="btn btn_primary"><span class="la la-plus"></span> Ajouter</button>
                        </div>
            <?php echo Form::close(); ?>


<?php echo $__env->make('admin.tarifs.ajaxAdd', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
                </div>
            </div>
<?php }  ?> 
        </div>
<?php echo $__env->make('components.pages.footer', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>        
    </main>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('layouts.master', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>